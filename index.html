<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Art Gallery Management System</title>
    <link rel="stylesheet" href="styles/main.css">
</head>
<body>
    <!-- Floating artistic elements -->
    <div class="floating-art">üé®</div>
    <div class="floating-art">üñºÔ∏è</div>
    <div class="floating-art">‚ú®</div>
    <div class="floating-art">üé≠</div>

    <div class="container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="logo">
                <h1>ArtGallery</h1>
                <p>Management System</p>
            </div>
            <div class="nav-menu">
                <a href="#" class="nav-item active" onclick="showTab('dashboard')">Dashboard</a>
                <a href="#" class="nav-item" onclick="showTab('customer')">Customer</a>
                <a href="#" class="nav-item" onclick="showTab('artist')">Artist</a>
                <a href="#" class="nav-item" onclick="showTab('room')">Room</a>
                <a href="#" class="nav-item" onclick="showTab('staff')">Staff</a>
                <a href="#" class="nav-item" onclick="showTab('exhibition')">Exhibition</a>
                <a href="#" class="nav-item" onclick="showTab('artwork')">Artwork</a>
                <a href="#" class="nav-item" onclick="showTab('ticket')">Ticket</a>
                <a href="#" class="nav-item" onclick="showTab('purchase')">Purchase</a>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <div class="header">
                <div class="header-info">
                    <h2 id="page-title">Dashboard</h2>
                    <p id="page-description">Overview of gallery operations and analytics</p>
                </div>
            </div>

            <div class="content-area">
                <!-- Dashboard Tab -->
                <div id="dashboard" class="tab-content active">
                    <div class="form-container">
                        <div class="form-header">
                            <h3>Gallery Analytics Dashboard</h3>
                            <p>Real-time insights and query results from the gallery database</p>
                        </div>
                        
                        <div class="dashboard-grid">
                            <div class="dashboard-card">
                                <h4>Total Customers</h4>
                                <div class="query-result" id="total-customers">
                                    Loading...
                                </div>
                            </div>
                            
                            <div class="dashboard-card">
                                <h4>Active Exhibitions</h4>
                                <div class="query-result" id="active-exhibitions">
                                    Loading...
                                </div>
                            </div>
                            
                            <div class="dashboard-card">
                                <h4>Artworks in Collection</h4>
                                <div class="query-result" id="total-artworks">
                                    Loading...
                                </div>
                            </div>
                            
                            <div class="dashboard-card">
                                <h4>Monthly Revenue</h4>
                                <div class="query-result" id="monthly-revenue">
                                    Loading...
                                </div>
                            </div>
                        </div>

                        <div class="dashboard-card">
                            <h4>Recent Transactions</h4>
                            <div class="query-result" id="recent-transactions">
                                Loading recent transactions...
                            </div>
                        </div>

                        <!-- Debug Section -->
                        <div class="dashboard-card">
                            <h4>üîß System Status</h4>
                            <div style="padding: 15px;">
                                <button class="btn btn-primary" onclick="testConnection()">Test API Connection</button>
                                <button class="btn btn-success" onclick="testSaveCustomer()">Test Save Customer</button>
                                <div id="debug-output" style="margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 8px; font-family: monospace; font-size: 12px; min-height: 50px; max-height: 300px; overflow-y: auto;">
                                    System ready. Click buttons above to test functionality.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Customer Tab -->
                <div id="customer" class="tab-content">
                    <div class="form-container">
                        <div class="form-header">
                            <h3>Customer Management</h3>
                            <p>Add, edit, and manage customer information</p>
                        </div>

                        <div class="mode-toggle">
                            <button class="mode-btn active" onclick="switchMode('customer', 'form')">Add New Customer</button>
                            <button class="mode-btn" onclick="switchMode('customer', 'table')">View All Customers</button>
                        </div>

                        <!-- Form Mode -->
                        <div id="customer-form-mode">
                            <div class="form-mode-indicator" id="customer-mode-indicator">Add New Customer</div>
                            
                            <form id="customer-form" class="form-grid" onsubmit="event.preventDefault(); saveRecord('customer');">
                                <div class="form-group">
                                    <label for="customer-name">Full Name</label>
                                    <input type="text" id="customer-name" name="customer-name" required>
                                </div>
                                <div class="form-group">
                                    <label for="customer-email">Email Address</label>
                                    <input type="email" id="customer-email" name="customer-email" required>
                                </div>
                                <div class="form-group">
                                    <label for="customer-phone">Phone Number</label>
                                    <input type="tel" id="customer-phone" name="customer-phone" required>
                                </div>
                                <div class="form-group" style="grid-column: 1 / -1;">
                                    <label for="customer-address">Address</label>
                                    <textarea id="customer-address" name="customer-address" required></textarea>
                                </div>
                            </form>
                            
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="clearForm('customer')">Clear</button>
                                <button type="button" class="btn btn-danger" onclick="deleteRecord('customer')" id="customer-delete-btn" style="display: none;">Delete</button>
                                <button type="button" class="btn btn-primary" onclick="saveRecord('customer')" id="customer-save-btn">Save Customer</button>
                            </div>
                        </div>

                        <!-- Table Mode -->
                        <div id="customer-table-mode" style="display: none;">
                            <div class="search-container">
                                <input type="text" class="search-input" placeholder="Search customers..." onkeyup="searchTable('customer-table', this.value)">
                                <button class="btn btn-primary btn-sm" onclick="refreshTable('customer')">Refresh</button>
                            </div>

                            <div class="table-container">
                                <table class="data-table" id="customer-table">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Email</th>
                                            <th>Phone</th>
                                            <th>Address</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="5" class="no-data">No customer records found. Add some customers to see them here.</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Artist Tab -->
                <div id="artist" class="tab-content">
                    <div class="form-container">
                        <div class="form-header">
                            <h3>Artist Management</h3>
                            <p>Manage artist profiles and information</p>
                        </div>

                        <div class="mode-toggle">
                            <button class="mode-btn active" onclick="switchMode('artist', 'form')">Add New Artist</button>
                            <button class="mode-btn" onclick="switchMode('artist', 'table')">View All Artists</button>
                        </div>

                        <!-- Form Mode -->
                        <div id="artist-form-mode">
                            <div class="form-mode-indicator" id="artist-mode-indicator">Add New Artist</div>
                            
                            <form id="artist-form" class="form-grid" onsubmit="event.preventDefault(); saveRecord('artist');">
                                <div class="form-group">
                                    <label for="artist-name">Artist Name</label>
                                    <input type="text" id="artist-name" name="artist-name" required>
                                </div>
                                <div class="form-group">
                                    <label for="artist-nationality">Nationality</label>
                                    <input type="text" id="artist-nationality" name="artist-nationality" required>
                                </div>
                                <div class="form-group">
                                    <label for="artist-birthdate">Birth Date</label>
                                    <input type="date" id="artist-birthdate" name="artist-birthdate" required>
                                </div>
                            </form>
                            
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="clearForm('artist')">Clear</button>
                                <button type="button" class="btn btn-danger" onclick="deleteRecord('artist')" id="artist-delete-btn" style="display: none;">Delete</button>
                                <button type="button" class="btn btn-primary" onclick="saveRecord('artist')" id="artist-save-btn">Save Artist</button>
                            </div>
                        </div>

                        <!-- Table Mode -->
                        <div id="artist-table-mode" style="display: none;">
                            <div class="search-container">
                                <input type="text" class="search-input" placeholder="Search artists..." onkeyup="searchTable('artist-table', this.value)">
                                <button class="btn btn-primary btn-sm" onclick="refreshTable('artist')">Refresh</button>
                            </div>

                            <div class="table-container">
                                <table class="data-table" id="artist-table">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Nationality</th>
                                            <th>Birth Date</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="4" class="no-data">No artist records found. Add some artists to see them here.</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Room Tab -->
                <div id="room" class="tab-content">
                    <div class="form-container">
                        <div class="form-header">
                            <h3>Room Management</h3>
                            <p>Configure gallery rooms and their specifications</p>
                        </div>

                        <div class="mode-toggle">
                            <button class="mode-btn active" onclick="switchMode('room', 'form')">Add New Room</button>
                            <button class="mode-btn" onclick="switchMode('room', 'table')">View All Rooms</button>
                        </div>

                        <!-- Form Mode -->
                        <div id="room-form-mode">
                            <div class="form-mode-indicator" id="room-mode-indicator">Add New Room</div>
                            
                            <form id="room-form" class="form-grid" onsubmit="event.preventDefault(); saveRecord('room');">
                                <div class="form-group">
                                    <label for="room-name">Room Name</label>
                                    <input type="text" id="room-name" name="room-name" required>
                                </div>
                                <div class="form-group">
                                    <label for="room-capacity">Capacity</label>
                                    <input type="number" id="room-capacity" name="room-capacity" required>
                                </div>
                            </form>
                            
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="clearForm('room')">Clear</button>
                                <button type="button" class="btn btn-danger" onclick="deleteRecord('room')" id="room-delete-btn" style="display: none;">Delete</button>
                                <button type="button" class="btn btn-primary" onclick="saveRecord('room')" id="room-save-btn">Save Room</button>
                            </div>
                        </div>

                        <!-- Table Mode -->
                        <div id="room-table-mode" style="display: none;">
                            <div class="search-container">
                                <input type="text" class="search-input" placeholder="Search rooms..." onkeyup="searchTable('room-table', this.value)">
                                <button class="btn btn-primary btn-sm" onclick="refreshTable('room')">Refresh</button>
                            </div>

                            <div class="table-container">
                                <table class="data-table" id="room-table">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Capacity</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="3" class="no-data">No room records found. Add some rooms to see them here.</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Staff Tab -->
                <div id="staff" class="tab-content">
                    <div class="form-container">
                        <div class="form-header">
                            <h3>Staff Management</h3>
                            <p>Manage gallery staff and their roles</p>
                        </div>

                        <div class="mode-toggle">
                            <button class="mode-btn active" onclick="switchMode('staff', 'form')">Add New Staff</button>
                            <button class="mode-btn" onclick="switchMode('staff', 'table')">View All Staff</button>
                        </div>

                        <!-- Form Mode -->
                        <div id="staff-form-mode">
                            <div class="form-mode-indicator" id="staff-mode-indicator">Add New Staff</div>
                            
                            <form id="staff-form" class="form-grid" onsubmit="event.preventDefault(); saveRecord('staff');">
                                <div class="form-group">
                                    <label for="staff-name">Staff Name</label>
                                    <input type="text" id="staff-name" name="staff-name" required>
                                </div>
                                <div class="form-group">
                                    <label for="staff-role">Role</label>
                                    <select id="staff-role" name="staff-role" required>
                                        <option value="">Select Role</option>
                                        <option value="Manager">Manager</option>
                                        <option value="Curator">Curator</option>
                                        <option value="Security">Security</option>
                                        <option value="Guide">Guide</option>
                                        <option value="Administrator">Administrator</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="staff-email">Email Address</label>
                                    <input type="email" id="staff-email" name="staff-email" required>
                                </div>
                                <div class="form-group">
                                    <label for="staff-phone">Phone Number</label>
                                    <input type="tel" id="staff-phone" name="staff-phone" required>
                                </div>
                            </form>
                            
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="clearForm('staff')">Clear</button>
                                <button type="button" class="btn btn-danger" onclick="deleteRecord('staff')" id="staff-delete-btn" style="display: none;">Delete</button>
                                <button type="button" class="btn btn-primary" onclick="saveRecord('staff')" id="staff-save-btn">Save Staff</button>
                            </div>
                        </div>

                        <!-- Table Mode -->
                        <div id="staff-table-mode" style="display: none;">
                            <div class="search-container">
                                <input type="text" class="search-input" placeholder="Search staff..." onkeyup="searchTable('staff-table', this.value)">
                                <button class="btn btn-primary btn-sm" onclick="refreshTable('staff')">Refresh</button>
                            </div>

                            <div class="table-container">
                                <table class="data-table" id="staff-table">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Role</th>
                                            <th>Email</th>
                                            <th>Phone</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="5" class="no-data">No staff records found. Add some staff to see them here.</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Exhibition Tab -->
                <div id="exhibition" class="tab-content">
                    <div class="form-container">
                        <div class="form-header">
                            <h3>Exhibition Management</h3>
                            <p>Create and manage gallery exhibitions</p>
                        </div>

                        <div class="mode-toggle">
                            <button class="mode-btn active" onclick="switchMode('exhibition', 'form')">Add New Exhibition</button>
                            <button class="mode-btn" onclick="switchMode('exhibition', 'table')">View All Exhibitions</button>
                        </div>

                        <!-- Form Mode -->
                        <div id="exhibition-form-mode">
                            <div class="form-mode-indicator" id="exhibition-mode-indicator">Add New Exhibition</div>
                            
                            <form id="exhibition-form" class="form-grid" onsubmit="event.preventDefault(); saveRecord('exhibition');">
                                <div class="form-group">
                                    <label for="exhibition-name">Exhibition Name</label>
                                    <input type="text" id="exhibition-name" name="exhibition-name" required>
                                </div>
                                <div class="form-group">
                                    <label for="exhibition-start">Start Date</label>
                                    <input type="date" id="exhibition-start" name="exhibition-start" required>
                                </div>
                                <div class="form-group">
                                    <label for="exhibition-end">End Date</label>
                                    <input type="date" id="exhibition-end" name="exhibition-end" required>
                                </div>
                                <div class="form-group">
                                    <label for="exhibition-room">Room ID</label>
                                    <input type="text" id="exhibition-room" name="exhibition-room" required>
                                </div>
                                <div class="form-group">
                                    <label for="exhibition-staff">Staff ID</label>
                                    <input type="text" id="exhibition-staff" name="exhibition-staff" required>
                                </div>
                            </form>
                            
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="clearForm('exhibition')">Clear</button>
                                <button type="button" class="btn btn-danger" onclick="deleteRecord('exhibition')" id="exhibition-delete-btn" style="display: none;">Delete</button>
                                <button type="button" class="btn btn-primary" onclick="saveRecord('exhibition')" id="exhibition-save-btn">Save Exhibition</button>
                            </div>
                        </div>

                        <!-- Table Mode -->
                        <div id="exhibition-table-mode" style="display: none;">
                            <div class="search-container">
                                <input type="text" class="search-input" placeholder="Search exhibitions..." onkeyup="searchTable('exhibition-table', this.value)">
                                <button class="btn btn-primary btn-sm" onclick="refreshTable('exhibition')">Refresh</button>
                            </div>

                            <div class="table-container">
                                <table class="data-table" id="exhibition-table">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Start Date</th>
                                            <th>End Date</th>
                                            <th>Room ID</th>
                                            <th>Staff ID</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="6" class="no-data">No exhibition records found. Add some exhibitions to see them here.</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Artwork Tab -->
                <div id="artwork" class="tab-content">
                    <div class="form-container">
                        <div class="form-header">
                            <h3>Artwork Management</h3>
                            <p>Catalog and manage artwork collection</p>
                        </div>

                        <div class="mode-toggle">
                            <button class="mode-btn active" onclick="switchMode('artwork', 'form')">Add New Artwork</button>
                            <button class="mode-btn" onclick="switchMode('artwork', 'table')">View All Artworks</button>
                        </div>

                        <!-- Form Mode -->
                        <div id="artwork-form-mode">
                            <div class="form-mode-indicator" id="artwork-mode-indicator">Add New Artwork</div>
                            
                            <form id="artwork-form" class="form-grid" onsubmit="event.preventDefault(); saveRecord('artwork');">
                                <div class="form-group">
                                    <label for="artwork-title">Title</label>
                                    <input type="text" id="artwork-title" name="artwork-title" required>
                                </div>
                                <div class="form-group">
                                    <label for="artwork-year">Year</label>
                                    <input type="number" id="artwork-year" name="artwork-year" required>
                                </div>
                                <div class="form-group">
                                    <label for="artwork-medium">Medium</label>
                                    <input type="text" id="artwork-medium" name="artwork-medium" required>
                                </div>
                                <div class="form-group">
                                    <label for="artwork-status">Status</label>
                                    <select id="artwork-status" name="artwork-status" required>
                                        <option value="">Select Status</option>
                                        <option value="Available">Available</option>
                                        <option value="On Display">On Display</option>
                                        <option value="Sold">Sold</option>
                                        <option value="On Loan">On Loan</option>
                                        <option value="In Storage">In Storage</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="artwork-artist">Artist ID</label>
                                    <input type="text" id="artwork-artist" name="artwork-artist" required>
                                </div>
                                <div class="form-group">
                                    <label for="artwork-room">Room ID</label>
                                    <input type="text" id="artwork-room" name="artwork-room">
                                </div>
                            </form>
                            
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="clearForm('artwork')">Clear</button>
                                <button type="button" class="btn btn-danger" onclick="deleteRecord('artwork')" id="artwork-delete-btn" style="display: none;">Delete</button>
                                <button type="button" class="btn btn-primary" onclick="saveRecord('artwork')" id="artwork-save-btn">Save Artwork</button>
                            </div>
                        </div>

                        <!-- Table Mode -->
                        <div id="artwork-table-mode" style="display: none;">
                            <div class="search-container">
                                <input type="text" class="search-input" placeholder="Search artworks..." onkeyup="searchTable('artwork-table', this.value)">
                                <button class="btn btn-primary btn-sm" onclick="refreshTable('artwork')">Refresh</button>
                            </div>

                            <div class="table-container">
                                <table class="data-table" id="artwork-table">
                                    <thead>
                                        <tr>
                                            <th>Title</th>
                                            <th>Year</th>
                                            <th>Medium</th>
                                            <th>Status</th>
                                            <th>Artist ID</th>
                                            <th>Room ID</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="7" class="no-data">No artwork records found. Add some artworks to see them here.</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ticket Tab -->
                <div id="ticket" class="tab-content">
                    <div class="form-container">
                        <div class="form-header">
                            <h3>Ticket Management</h3>
                            <p>Process and manage exhibition tickets</p>
                        </div>

                        <div class="mode-toggle">
                            <button class="mode-btn active" onclick="switchMode('ticket', 'form')">Add New Ticket</button>
                            <button class="mode-btn" onclick="switchMode('ticket', 'table')">View All Tickets</button>
                        </div>

                        <!-- Form Mode -->
                        <div id="ticket-form-mode">
                            <div class="form-mode-indicator" id="ticket-mode-indicator">Add New Ticket</div>
                            
                            <form id="ticket-form" class="form-grid" onsubmit="event.preventDefault(); saveRecord('ticket');">
                                <div class="form-group">
                                    <label for="ticket-customer">Customer ID</label>
                                    <input type="text" id="ticket-customer" name="ticket-customer" required>
                                </div>
                                <div class="form-group">
                                    <label for="ticket-exhibition">Exhibition ID</label>
                                    <input type="text" id="ticket-exhibition" name="ticket-exhibition" required>
                                </div>
                                <div class="form-group">
                                    <label for="ticket-purchase-date">Purchase Date</label>
                                    <input type="date" id="ticket-purchase-date" name="ticket-purchase-date" required>
                                </div>
                                <div class="form-group">
                                    <label for="ticket-price">Price</label>
                                    <input type="number" id="ticket-price" name="ticket-price" step="0.01" required>
                                </div>
                            </form>
                            
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="clearForm('ticket')">Clear</button>
                                <button type="button" class="btn btn-danger" onclick="deleteRecord('ticket')" id="ticket-delete-btn" style="display: none;">Delete</button>
                                <button type="button" class="btn btn-primary" onclick="saveRecord('ticket')" id="ticket-save-btn">Save Ticket</button>
                            </div>
                        </div>

                        <!-- Table Mode -->
                        <div id="ticket-table-mode" style="display: none;">
                            <div class="search-container">
                                <input type="text" class="search-input" placeholder="Search tickets..." onkeyup="searchTable('ticket-table', this.value)">
                                <button class="btn btn-primary btn-sm" onclick="refreshTable('ticket')">Refresh</button>
                            </div>

                            <div class="table-container">
                                <table class="data-table" id="ticket-table">
                                    <thead>
                                        <tr>
                                            <th>Customer ID</th>
                                            <th>Exhibition ID</th>
                                            <th>Purchase Date</th>
                                            <th>Price</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="5" class="no-data">No ticket records found. Add some tickets to see them here.</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Purchase Tab -->
                <div id="purchase" class="tab-content">
                    <div class="form-container">
                        <div class="form-header">
                            <h3>Purchase Management</h3>
                            <p>Record and manage artwork purchases</p>
                        </div>

                        <div class="mode-toggle">
                            <button class="mode-btn active" onclick="switchMode('purchase', 'form')">Add New Purchase</button>
                            <button class="mode-btn" onclick="switchMode('purchase', 'table')">View All Purchases</button>
                        </div>

                        <!-- Form Mode -->
                        <div id="purchase-form-mode">
                            <div class="form-mode-indicator" id="purchase-mode-indicator">Add New Purchase</div>
                            
                            <form id="purchase-form" class="form-grid" onsubmit="event.preventDefault(); saveRecord('purchase');">
                                <div class="form-group">
                                    <label for="purchase-customer">Customer ID</label>
                                    <input type="text" id="purchase-customer" name="purchase-customer" required>
                                </div>
                                <div class="form-group">
                                    <label for="purchase-artwork">Artwork ID</label>
                                    <input type="text" id="purchase-artwork" name="purchase-artwork" required>
                                </div>
                                <div class="form-group">
                                    <label for="purchase-date">Purchase Date</label>
                                    <input type="date" id="purchase-date" name="purchase-date" required>
                                </div>
                                <div class="form-group">
                                    <label for="purchase-price">Price</label>
                                    <input type="number" id="purchase-price" name="purchase-price" step="0.01" required>
                                </div>
                            </form>
                            
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="clearForm('purchase')">Clear</button>
                                <button type="button" class="btn btn-danger" onclick="deleteRecord('purchase')" id="purchase-delete-btn" style="display: none;">Delete</button>
                                <button type="button" class="btn btn-primary" onclick="saveRecord('purchase')" id="purchase-save-btn">Save Purchase</button>
                            </div>
                        </div>

                        <!-- Table Mode -->
                        <div id="purchase-table-mode" style="display: none;">
                            <div class="search-container">
                                <input type="text" class="search-input" placeholder="Search purchases..." onkeyup="searchTable('purchase-table', this.value)">
                                <button class="btn btn-primary btn-sm" onclick="refreshTable('purchase')">Refresh</button>
                            </div>

                            <div class="table-container">
                                <table class="data-table" id="purchase-table">
                                    <thead>
                                        <tr>
                                            <th>Customer ID</th>
                                            <th>Artwork ID</th>
                                            <th>Purchase Date</th>
                                            <th>Price</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="5" class="no-data">No purchase records found. Add some purchases to see them here.</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ========================================= -->
    <!-- MODULE 1: GLOBAL VARIABLES & UTILITIES   -->
    <!-- ========================================= -->
    <script>
        console.log("üé® MODULE 1: Loading Global Variables & Utilities...");
        
        // Global state variables
        let currentEditingRecord = null;
        let currentEntity = null;
        
        // Debug function to log messages to both console and debug output
        function debugLog(message, type = 'info') {
            console.log(message);
            const debugOutput = document.getElementById('debug-output');
            if (debugOutput) {
                const timestamp = new Date().toLocaleTimeString();
                const color = type === 'error' ? '#dc3545' : type === 'success' ? '#28a745' : '#007bff';
                debugOutput.innerHTML += `<div style="color: ${color}; margin: 2px 0;">[${timestamp}] ${message}</div>`;
                debugOutput.scrollTop = debugOutput.scrollHeight;
            }
        }
        
        // Utility function to get API endpoint name
        function getApiEndpoint(entity) {
            const entityMap = {
                customer: "customers",
                artist: "artists", 
                room: "rooms",
                staff: "staff",
                exhibition: "exhibitions",
                artwork: "artworks",
                ticket: "tickets",
                purchase: "purchases"
            };
            return entityMap[entity] || entity + "s";
        }
        
        debugLog("‚úÖ MODULE 1: Global Variables & Utilities loaded successfully");
    </script>

    <!-- ========================================= -->
    <!-- MODULE 2: TAB NAVIGATION SYSTEM          -->
    <!-- ========================================= -->
    <script>
        console.log("üé® MODULE 2: Loading Tab Navigation System...");
        
        // Tab switching functionality
        function showTab(tabName) {
            debugLog(`üîÑ Switching to tab: ${tabName}`);
            
            // Hide all tab contents
            const tabContents = document.querySelectorAll(".tab-content");
            tabContents.forEach((tab) => {
                tab.classList.remove("active");
            });

            // Remove active class from all nav items
            const navItems = document.querySelectorAll(".nav-item");
            navItems.forEach((item) => {
                item.classList.remove("active");
            });

            // Show selected tab
            const selectedTab = document.getElementById(tabName);
            if (selectedTab) {
                selectedTab.classList.add("active");
            }

            // Add active class to clicked nav item
            if (event && event.target) {
                event.target.classList.add("active");
            }

            // Update page title and description
            const titles = {
                dashboard: { title: "Dashboard", desc: "Overview of gallery operations and analytics" },
                customer: { title: "Customer Management", desc: "Manage customer information and profiles" },
                artist: { title: "Artist Management", desc: "Manage artist profiles and information" },
                room: { title: "Room Management", desc: "Configure gallery rooms and specifications" },
                staff: { title: "Staff Management", desc: "Manage gallery staff and their roles" },
                exhibition: { title: "Exhibition Management", desc: "Create and manage gallery exhibitions" },
                artwork: { title: "Artwork Management", desc: "Catalog and manage artwork collection" },
                ticket: { title: "Ticket Management", desc: "Process and manage exhibition tickets" },
                purchase: { title: "Purchase Management", desc: "Record and manage artwork purchases" }
            };

            const pageTitle = document.getElementById("page-title");
            const pageDescription = document.getElementById("page-description");

            if (pageTitle && titles[tabName]) {
                pageTitle.textContent = titles[tabName].title;
            }
            if (pageDescription && titles[tabName]) {
                pageDescription.textContent = titles[tabName].desc;
            }

            currentEntity = tabName;

            // Load dashboard data if dashboard tab is selected
            if (tabName === "dashboard") {
                loadDashboardData();
            }
            
            debugLog(`‚úÖ Successfully switched to ${tabName} tab`);
        }
        
        debugLog("‚úÖ MODULE 2: Tab Navigation System loaded successfully");
    </script>

    <!-- ========================================= -->
    <!-- MODULE 3: API COMMUNICATION SYSTEM       -->
    <!-- ========================================= -->
    <script>
        console.log("üé® MODULE 3: Loading API Communication System...");
        
        // API Helper Functions
        async function apiRequest(endpoint, method = "GET", data = null) {
            const config = {
                method: method,
                headers: {
                    "Content-Type": "application/json",
                },
            };

            if (data && method !== "GET") {
                config.body = JSON.stringify(data);
            }

            debugLog(`üì° API Request: ${method} ${endpoint}`, 'info');
            if (data) {
                debugLog(`üì§ Request Data: ${JSON.stringify(data)}`, 'info');
            }

            try {
                const response = await fetch(`api/${endpoint}`, config);
                const responseText = await response.text();

                debugLog(`üì• Raw Response: ${responseText.substring(0, 200)}...`, 'info');

                let result;
                try {
                    result = JSON.parse(responseText);
                } catch (parseError) {
                    debugLog(`‚ùå JSON Parse Error: ${parseError.message}`, 'error');
                    throw new Error(`Invalid response: ${responseText.substring(0, 100)}...`);
                }

                if (!response.ok) {
                    debugLog(`‚ùå API Error: ${result.error || `HTTP ${response.status}`}`, 'error');
                    throw new Error(result.error || `HTTP ${response.status}`);
                }

                debugLog(`‚úÖ API Success: ${JSON.stringify(result).substring(0, 100)}...`, 'success');
                return result;
            } catch (error) {
                debugLog(`‚ùå API Request Failed: ${error.message}`, 'error');
                throw error;
            }
        }
        
        // Test API connection function
        async function testConnection() {
            debugLog("üîç Testing API connection...", 'info');
            try {
                const response = await apiRequest("customers.php");
                debugLog("‚úÖ API Connection Test: SUCCESS", 'success');
                debugLog(`üìä Found ${response.length || 0} customers in database`, 'info');
            } catch (error) {
                debugLog(`‚ùå API Connection Test: FAILED - ${error.message}`, 'error');
            }
        }
        
        debugLog("‚úÖ MODULE 3: API Communication System loaded successfully");
    </script>

    <!-- ========================================= -->
    <!-- MODULE 4: DASHBOARD DATA MANAGEMENT       -->
    <!-- ========================================= -->
    <script>
        console.log("üé® MODULE 4: Loading Dashboard Data Management...");
        
        // Load Dashboard Data
        async function loadDashboardData() {
            debugLog("üìä Loading dashboard data...", 'info');
            try {
                const data = await apiRequest("dashboard.php");

                // Update dashboard cards
                const totalCustomers = document.getElementById("total-customers");
                const activeExhibitions = document.getElementById("active-exhibitions");
                const totalArtworks = document.getElementById("total-artworks");
                const monthlyRevenue = document.getElementById("monthly-revenue");
                const recentTransactions = document.getElementById("recent-transactions");

                if (totalCustomers) {
                    totalCustomers.innerHTML = `<strong>${data.total_customers || 0}</strong> registered customers`;
                }

                if (activeExhibitions) {
                    activeExhibitions.innerHTML = `<strong>${data.active_exhibitions || 0}</strong> currently running`;
                }

                if (totalArtworks) {
                    totalArtworks.innerHTML = `<strong>${data.total_artworks || 0}</strong> pieces in collection`;
                }

                if (monthlyRevenue) {
                    monthlyRevenue.innerHTML = `<strong>$${Number.parseFloat(data.total_monthly_revenue || 0).toLocaleString()}</strong> this month`;
                }

                // Update recent transactions
                if (recentTransactions) {
                    if (data.recent_transactions && data.recent_transactions.length > 0) {
                        let transactionsHtml = '<div style="max-height: 200px; overflow-y: auto;">';
                        data.recent_transactions.forEach((transaction) => {
                            transactionsHtml += `
                                <div style="padding: 8px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between;">
                                    <div>
                                        <strong>${transaction.customer_name}</strong><br>
                                        <small>${transaction.type}: ${transaction.item_name}</small>
                                    </div>
                                    <div style="text-align: right;">
                                        <strong>$${Number.parseFloat(transaction.price).toLocaleString()}</strong><br>
                                        <small>${transaction.purchase_date}</small>
                                    </div>
                                </div>
                            `;
                        });
                        transactionsHtml += "</div>";
                        recentTransactions.innerHTML = transactionsHtml;
                    } else {
                        recentTransactions.innerHTML = "No recent transactions found";
                    }
                }
                
                debugLog("‚úÖ Dashboard data loaded successfully", 'success');
            } catch (error) {
                debugLog(`‚ùå Failed to load dashboard data: ${error.message}`, 'error');
            }
        }
        
        debugLog("‚úÖ MODULE 4: Dashboard Data Management loaded successfully");
    </script>

    <!-- ========================================= -->
    <!-- MODULE 5: FORM MANAGEMENT SYSTEM         -->
    <!-- ========================================= -->
    <script>
        console.log("üé® MODULE 5: Loading Form Management System...");
        
        // Mode switching (Form vs Table view)
        function switchMode(entity, mode) {
            debugLog(`üîÑ Switching ${entity} to ${mode} mode`, 'info');

            const formMode = document.getElementById(`${entity}-form-mode`);
            const tableMode = document.getElementById(`${entity}-table-mode`);
            const modeButtons = document.querySelectorAll(`#${entity} .mode-btn`);

            if (!formMode || !tableMode) {
                debugLog(`‚ùå Mode elements not found for entity: ${entity}`, 'error');
                return;
            }

            // Reset mode buttons
            modeButtons.forEach((btn) => btn.classList.remove("active"));

            if (mode === "form") {
                formMode.style.display = "block";
                tableMode.style.display = "none";
                if (modeButtons[0]) modeButtons[0].classList.add("active");
                clearForm(entity);
            } else {
                formMode.style.display = "none";
                tableMode.style.display = "block";
                if (modeButtons[1]) modeButtons[1].classList.add("active");
                refreshTable(entity);
            }
            
            debugLog(`‚úÖ Successfully switched ${entity} to ${mode} mode`, 'success');
        }

        // Clear form
        function clearForm(entity) {
            debugLog(`üßπ Clearing form for ${entity}`, 'info');

            const form = document.getElementById(`${entity}-form`);
            if (form) {
                form.reset();
            }

            // Reset to add mode
            currentEditingRecord = null;
            updateFormMode(entity, "add");
            
            debugLog(`‚úÖ Form cleared for ${entity}`, 'success');
        }

        // Update form mode indicator and buttons
        function updateFormMode(entity, mode) {
            const indicator = document.getElementById(`${entity}-mode-indicator`);
            const deleteBtn = document.getElementById(`${entity}-delete-btn`);
            const saveBtn = document.getElementById(`${entity}-save-btn`);

            if (indicator) {
                if (mode === "add") {
                    indicator.textContent = `Add New ${entity.charAt(0).toUpperCase() + entity.slice(1)}`;
                    indicator.className = "form-mode-indicator";
                } else {
                    indicator.textContent = `Edit ${entity.charAt(0).toUpperCase() + entity.slice(1)}`;
                    indicator.className = "form-mode-indicator edit-mode";
                }
            }

            if (deleteBtn) {
                deleteBtn.style.display = mode === "add" ? "none" : "inline-block";
            }

            if (saveBtn) {
                saveBtn.textContent = mode === "add" 
                    ? `Save ${entity.charAt(0).toUpperCase() + entity.slice(1)}`
                    : `Update ${entity.charAt(0).toUpperCase() + entity.slice(1)}`;
            }
        }
        
        debugLog("‚úÖ MODULE 5: Form Management System loaded successfully");
    </script>

    <!-- ========================================= -->
    <!-- MODULE 6: DATA PERSISTENCE SYSTEM        -->
    <!-- ========================================= -->
    <script>
        console.log("üé® MODULE 6: Loading Data Persistence System...");
        
        // Save record (Create or Update)
        async function saveRecord(entity) {
            debugLog(`üíæ Saving ${entity} record...`, 'info');

            const form = document.getElementById(`${entity}-form`);
            if (!form) {
                debugLog(`‚ùå Form not found for entity: ${entity}`, 'error');
                alert(`Form not found for ${entity}`);
                return;
            }

            const formData = new FormData(form);
            const record = {};

            // Convert FormData to object with proper field mapping
            for (const [key, value] of formData.entries()) {
                let fieldName = key.replace(`${entity}-`, "");

                // Handle special field mappings
                if (fieldName === "start") fieldName = "start_date";
                if (fieldName === "end") fieldName = "end_date";
                if (fieldName === "room") fieldName = "room_id";
                if (fieldName === "staff") fieldName = "staff_id";
                if (fieldName === "artist") fieldName = "artist_id";
                if (fieldName === "customer") fieldName = "customer_id";
                if (fieldName === "exhibition") fieldName = "exhibition_id";
                if (fieldName === "artwork") fieldName = "artwork_id";
                if (fieldName === "purchase-date") fieldName = "purchase_date";
                if (fieldName === "date") fieldName = "purchase_date";

                record[fieldName] = value;
            }

            debugLog(`üìù Record data: ${JSON.stringify(record)}`, 'info');

            // Basic validation
            if (Object.values(record).some((value) => value === "")) {
                debugLog("‚ùå Validation failed: Empty fields detected", 'error');
                alert("Please fill in all required fields");
                return;
            }

            try {
                const endpoint = getApiEndpoint(entity);
                let response;

                if (currentEditingRecord !== null) {
                    // Update existing record
                    record.id = currentEditingRecord;
                    debugLog(`üîÑ Updating ${entity} with ID ${currentEditingRecord}`, 'info');
                    response = await apiRequest(`${endpoint}.php`, "PUT", record);
                    alert(`${entity.charAt(0).toUpperCase() + entity.slice(1)} updated successfully!`);
                    debugLog(`‚úÖ ${entity} updated successfully`, 'success');
                } else {
                    // Add new record
                    debugLog(`‚ûï Creating new ${entity}`, 'info');
                    response = await apiRequest(`${endpoint}.php`, "POST", record);
                    alert(`${entity.charAt(0).toUpperCase() + entity.slice(1)} added successfully!`);
                    debugLog(`‚úÖ ${entity} created successfully`, 'success');
                }

                // Clear form and refresh table if in table view
                clearForm(entity);
                const tableMode = document.getElementById(`${entity}-table-mode`);
                if (tableMode && tableMode.style.display !== "none") {
                    refreshTable(entity);
                }
            } catch (error) {
                debugLog(`‚ùå Save failed: ${error.message}`, 'error');
            }
        }

        // Delete record
        async function deleteRecord(entity) {
            if (currentEditingRecord !== null) {
                if (confirm(`Are you sure you want to delete this ${entity} record?`)) {
                    debugLog(`üóëÔ∏è Deleting ${entity} with ID ${currentEditingRecord}`, 'info');
                    try {
                        const endpoint = getApiEndpoint(entity);
                        await apiRequest(`${endpoint}.php`, "DELETE", { id: currentEditingRecord });
                        alert(`${entity.charAt(0).toUpperCase() + entity.slice(1)} deleted successfully!`);
                        debugLog(`‚úÖ ${entity} deleted successfully`, 'success');
                        clearForm(entity);
                        refreshTable(entity);
                    } catch (error) {
                        debugLog(`‚ùå Delete failed: ${error.message}`, 'error');
                    }
                }
            }
        }
        
        // Test save customer function
        async function testSaveCustomer() {
            debugLog("üß™ Testing customer save functionality...", 'info');
            
            // Fill form with test data
            const form = document.getElementById('customer-form');
            if (form) {
                document.getElementById('customer-name').value = 'Test Customer ' + Date.now();
                document.getElementById('customer-email').value = 'test' + Date.now() + '@example.com';
                document.getElementById('customer-phone').value = '+1-555-TEST';
                document.getElementById('customer-address').value = '123 Test Street, Test City';
                
                debugLog("üìù Test data filled in customer form", 'info');
                
                // Save the record
                await saveRecord('customer');
            } else {
                debugLog("‚ùå Customer form not found", 'error');
            }
        }
        
        debugLog("‚úÖ MODULE 6: Data Persistence System loaded successfully");
    </script>

    <!-- ========================================= -->
    <!-- MODULE 7: TABLE MANAGEMENT SYSTEM        -->
    <!-- ========================================= -->
    <script>
        console.log("üé® MODULE 7: Loading Table Management System...");
        
        // Refresh table data
        async function refreshTable(entity) {
            debugLog(`üîÑ Refreshing table for ${entity}`, 'info');

            const table = document.getElementById(`${entity}-table`);
            if (!table) {
                debugLog(`‚ùå Table not found for entity: ${entity}`, 'error');
                return;
            }

            const tbody = table.querySelector("tbody");
            if (!tbody) {
                debugLog(`‚ùå Table body not found for entity: ${entity}`, 'error');
                return;
            }

            try {
                const endpoint = getApiEndpoint(entity);
                const data = await apiRequest(`${endpoint}.php`);

                // Clear existing rows
                tbody.innerHTML = "";

                if (!data || data.length === 0) {
                    tbody.innerHTML = `<tr><td colspan="100%" class="no-data">No ${entity} records found. Add some ${entity}s to see them here.</td></tr>`;
                    debugLog(`‚ÑπÔ∏è No ${entity} records found`, 'info');
                    return;
                }

                // Add data rows
                data.forEach((record) => {
                    const row = createTableRow(entity, record);
                    tbody.appendChild(row);
                });
                
                debugLog(`‚úÖ Table refreshed with ${data.length} ${entity} records`, 'success');
            } catch (error) {
                tbody.innerHTML = `<tr><td colspan="100%" class="no-data">Error loading ${entity} data. Please try again.</td></tr>`;
                debugLog(`‚ùå Table refresh failed: ${error.message}`, 'error');
            }
        }

        // Create table row
        function createTableRow(entity, record) {
            const row = document.createElement("tr");

            // Add data cells based on entity type
            const fields = getEntityFields(entity);
            fields.forEach((field) => {
                const cell = document.createElement("td");
                const value = record[field] || "";

                // Special formatting for certain fields
                if (field === "status" && entity === "artwork") {
                    cell.innerHTML = `<span class="status-badge status-${value.toLowerCase().replace(" ", "")}">${value}</span>`;
                } else if (field.includes("price") && value) {
                    cell.textContent = `$${Number.parseFloat(value).toLocaleString()}`;
                } else {
                    cell.textContent = value || "N/A";
                }

                row.appendChild(cell);
            });

            // Add actions cell
            const actionsCell = document.createElement("td");
            actionsCell.innerHTML = `
                <div class="action-buttons">
                    <button class="btn btn-warning btn-sm" onclick="editRecord('${entity}', ${record.id})">Edit</button>
                    <button class="btn btn-danger btn-sm" onclick="deleteFromTable('${entity}', ${record.id})">Delete</button>
                </div>
            `;
            row.appendChild(actionsCell);

            return row;
        }

        // Get entity fields for table display
        function getEntityFields(entity) {
            const fieldMap = {
                customer: ["name", "email", "phone", "address"],
                artist: ["name", "nationality", "birthdate"],
                room: ["name", "capacity"],
                staff: ["name", "role", "email", "phone"],
                exhibition: ["name", "start_date", "end_date", "room_id", "staff_id"],
                artwork: ["title", "year", "medium", "status", "artist_id", "room_id"],
                ticket: ["customer_id", "exhibition_id", "purchase_date", "price"],
                purchase: ["customer_id", "artwork_id", "purchase_date", "price"]
            };
            return fieldMap[entity] || [];
        }

        // Edit record
        function editRecord(entity, id) {
            debugLog(`‚úèÔ∏è Editing ${entity} record with ID: ${id}`, 'info');
            currentEditingRecord = id;
            updateFormMode(entity, "edit");
            switchMode(entity, "form");
        }

        // Delete record from table
        async function deleteFromTable(entity, id) {
            if (confirm(`Are you sure you want to delete this ${entity} record?`)) {
                debugLog(`üóëÔ∏è Deleting ${entity} with ID ${id} from table`, 'info');
                try {
                    const endpoint = getApiEndpoint(entity);
                    await apiRequest(`${endpoint}.php`, "DELETE", { id: id });
                    alert(`${entity.charAt(0).toUpperCase() + entity.slice(1)} deleted successfully!`);
                    debugLog(`‚úÖ ${entity} deleted successfully from table`, 'success');
                    refreshTable(entity);
                } catch (error) {
                    debugLog(`‚ùå Delete from table failed: ${error.message}`, 'error');
                }
            }
        }

        // Search table
        function searchTable(tableId, searchTerm) {
            const table = document.getElementById(tableId);
            if (!table) return;

            const rows = table.querySelectorAll("tbody tr");

            rows.forEach((row) => {
                const text = row.textContent.toLowerCase();
                const matches = text.includes(searchTerm.toLowerCase());
                row.style.display = matches ? "" : "none";
            });
            
            debugLog(`üîç Search applied to ${tableId} with term: "${searchTerm}"`, 'info');
        }
        
        debugLog("‚úÖ MODULE 7: Table Management System loaded successfully");
    </script>

    <!-- ========================================= -->
    <!-- MODULE 8: INITIALIZATION SYSTEM          -->
    <!-- ========================================= -->
    <script>
        console.log("üé® MODULE 8: Loading Initialization System...");
        
        // Initialize the application
        document.addEventListener("DOMContentLoaded", () => {
            debugLog("üöÄ Art Gallery Management System initializing...", 'info');

            // Set current entity to dashboard
            currentEntity = "dashboard";

            // Load dashboard data after a short delay
            setTimeout(() => {
                loadDashboardData();
            }, 500);

            debugLog("‚úÖ Art Gallery Management System initialized successfully!", 'success');
            debugLog("üéØ Ready to use! Try the test buttons above.", 'info');
        });
        
        debugLog("‚úÖ MODULE 8: Initialization System loaded successfully");
        debugLog("üéâ ALL MODULES LOADED SUCCESSFULLY! System is ready to use.", 'success');
    </script>
</body>
</html>
